# Custom Agents Usage Analysis

**Date**: January 28, 2026  
**Issue**: Why are custom agents not being used in the automated workflow?

---

## Fact-Check: Custom Agent Tools

**Question**: Does GitHub Copilot have `runSubagent` or `agent` tools?

**Answer**: 
- ✅ **YES**: GitHub Copilot Coding Agent has a `task` tool for invoking custom agents
- ❌ **NO**: There is NO `runSubagent` tool (this is a naming error in `publisher.agent.md`)
- ❌ **NO**: There is NO standalone `agent` tool (the correct tool is `task`)

**Evidence**:
- Custom agents are defined in `.github/agents/*.agent.md` files in this repository
- Each agent file has metadata: `name`, `description`, and `tools` fields
- The `task` tool is the standard mechanism for invoking custom agents
- Parameters: `agent_type` (string), `description` (string), `prompt` (string)

**Correct syntax**:
```javascript
task({
  agent_type: "content-generator",
  description: "Generate WHATS-NEW.md",
  prompt: "Create WHATS-NEW.md from data/changes-summary.json..."
})
```

**Source**: GitHub Copilot Coding Agent system instructions and `.github/agents/` configuration files in this repository.

---

## Executive Summary

**Problem**: Only the publisher agent is being used. The other 6 custom agents remain unused.

**Root Cause**: The `.github/copilot-instructions.md` file does not inform @copilot about the existence of custom agents or how to invoke them using the `task` tool.

**Impact**: @copilot does all work itself instead of delegating to specialized agents, missing opportunities for:
- Better separation of concerns
- Specialized expertise per task
- More efficient workflows
- Code reusability

---

## Detailed Analysis

### 1. Available Custom Agents

Seven custom agents exist in `.github/agents/`:

| Agent | Purpose | Status |
|-------|---------|--------|
| **publisher** | Editor-in-Chief, orchestrates content synthesis | ✅ Used (manual) |
| **content-generator** | Generates markdown from data | ❌ Unused |
| **link-validator** | Validates/fixes broken links | ⚠️ Rarely used |
| **feed-fetcher** | Fetches RSS/Atom feeds | ❌ Unused (Python does this) |
| **youtube-specialist** | YouTube integration | ❌ Unused (Python does this) |
| **change-detector** | Tracks changes/metadata | ❌ Unused (Python does this) |
| **infrastructure-architect** | Setup/migration | ❌ Unused (one-time use) |

### 2. How Custom Agents Should Be Invoked

**FACT-CHECK (Jan 28, 2026)**: GitHub Copilot Coding Agent provides a `task` tool for invoking custom agents.

**Evidence**:
- The `task` tool is documented in the Copilot system instructions
- Custom agents are defined in `.github/agents/*.agent.md` files
- Agent metadata includes `name`, `description`, and `tools` fields
- The `task` tool accepts `agent_type`, `description`, and `prompt` parameters

**There is NO `runSubagent` tool** - this appears to be a naming error in the publisher agent configuration.

**Correct invocation syntax**:
```javascript
task({
  agent_type: "content-generator",
  description: "Generate WHATS-NEW.md",
  prompt: "Create WHATS-NEW.md from data/changes-summary.json..."
})
```

**Available agent types** (from `.github/agents/` directory):
- `"change-detector"`
- `"content-generator"`
- `"feed-fetcher"`
- `"infrastructure-architect"`
- `"link-validator"`
- `"publisher"`
- `"youtube-specialist"`

### 3. Current Workflow

**What happens now**:

```
GitHub Actions Workflow (daily-agent.yml)
  ↓
  Runs Python scrapers (fetch_docs.py, fetch_blog.py, etc.)
  ↓
  Detects changes (detect_changes.py)
  ↓
  Creates GitHub issue with content update task
  ↓
  Assigns issue to @copilot
  ↓
  @copilot reads .github/copilot-instructions.md
  ↓
  @copilot does ALL work itself (no delegation)
  ↓
  Creates PR
```

**Problem**: Step "@copilot reads .github/copilot-instructions.md" doesn't mention custom agents!

### 4. Root Cause Details

#### Problem 1: copilot-instructions.md Doesn't Mention Custom Agents

The file `.github/copilot-instructions.md` (958 lines):
- ❌ No mention of "custom agent"
- ❌ No mention of "task tool"
- ❌ No mention of agent delegation patterns
- ❌ No mention of available custom agents

**Result**: @copilot doesn't know custom agents exist or how to use them.

#### Problem 2: Publisher Agent Uses Non-Existent "runSubagent"

File: `.github/agents/publisher.agent.md`

Line 4: `tools: ["runSubagent", "view", "create", "edit", "search", "bash"]`

Lines 413-416:
```markdown
Use runSubagent for specialized tasks:
- VIDEOS.md is auto-generated by Python (no delegation needed)
- Complex video analysis: delegate to youtube-specialist agent if needed
```

**Problem**: `runSubagent` is NOT a real tool in GitHub Copilot!
- It appears to be a conceptual placeholder
- The correct tool is `task`
- Publisher agent config is misleading

#### Problem 3: No Agent Discovery Mechanism

When @copilot is assigned an issue:
1. It reads `.github/copilot-instructions.md` (main instructions)
2. That file doesn't mention custom agents
3. @copilot doesn't read individual `.agent.md` files unless explicitly told
4. Custom agents remain invisible to the workflow

### 5. Evidence from Existing Documentation

File: `docs/AGENT_WORKFLOW_ANALYSIS.md` (created Jan 12, 2026)

This document identified the problem and recommended solutions:

**Quote from lines 60-62**:
> **Current Gap**: Not using runSubagent delegation or other agents

**Quote from lines 80-90**:
> **Publisher agent should orchestrate using runSubagent:**
> 
> ```markdown
> @copilot triggered →
>   publisher agent:
>     1. Verify data exists (pre-flight check)
>     2. Synthesize core content files
>     3. runSubagent → content-generator for WHATS-NEW.md
>     4. runSubagent → link-validator for all content
>     5. Create comprehensive PR
> ```

**Quote from lines 262-264**:
> **Action Items**:
> 2. ✅ Enhance publisher agent to use runSubagent delegation

**Status**: This recommendation was documented but NEVER implemented.

---

## Recommended Solutions

### Solution 1: Update copilot-instructions.md (CRITICAL)

Add a section about custom agents to `.github/copilot-instructions.md`:

```markdown
## Custom Agents Available

This repository has specialized custom agents. Use the `task` tool to delegate work:

### Available Agents

- **content-generator** - Generates markdown content from data
  - Use for: WHATS-NEW.md, TRAININGS.md, complex formatting
  
- **link-validator** - Validates and fixes broken links
  - Use for: Quality gate after content generation
  
- **youtube-specialist** - YouTube content analysis
  - Use for: Complex video categorization (rarely needed)

### How to Delegate

Use the `task` tool with `agent_type` parameter:

```javascript
task({
  agent_type: "content-generator",
  description: "Generate WHATS-NEW.md",
  prompt: "Create WHATS-NEW.md from data/changes-summary.json. 
          Filter to last 30 days, sort newest first..."
})
```

### When to Delegate

- Complex formatting tasks → content-generator
- Link validation → link-validator
- After ALL content generation → link-validator (mandatory)
```

### Solution 2: Fix Publisher Agent Config

File: `.github/agents/publisher.agent.md`

**Change line 4** from:
```yaml
tools: ["runSubagent", "view", "create", "edit", "search", "bash"]
```

To:
```yaml
tools: ["view", "create", "edit", "search", "bash"]
```

**Update lines 413-416** from:
```markdown
Use runSubagent for specialized tasks:
```

To:
```markdown
Use the `task` tool to delegate to specialized agents:

Example:
```javascript
task({
  agent_type: "content-generator",
  description: "Generate WHATS-NEW.md",
  prompt: "Create WHATS-NEW.md..."
})
```

Delegate to:
- content-generator: For WHATS-NEW.md, TRAININGS.md
- link-validator: Always, after all content generation
```

### Solution 3: Add Custom Agent Reference to Issue Template

Update the issue body in `daily-agent.yml` (line 131):

**Add this section**:
```markdown
### Custom Agents Available

Delegate specialized tasks using the `task` tool:
- `content-generator` - Complex content formatting
- `link-validator` - Link validation (mandatory quality gate)

Example:
```javascript
task({agent_type: "link-validator", description: "Validate links", prompt: "..."})
```
```

### Solution 4: Archive Unused Agents (Optional)

Based on `AGENT_WORKFLOW_ANALYSIS.md` recommendations:

**Archive these agents** (Python scripts do this work better):
- feed-fetcher.agent.md → `.github/agents/archived/`
- change-detector.agent.md → `.github/agents/archived/`

**Keep as optional**:
- youtube-specialist.agent.md (rarely needed)

**Keep active**:
- publisher.agent.md (orchestrator)
- content-generator.agent.md (complex formatting)
- link-validator.agent.md (quality gate)
- infrastructure-architect.agent.md (future use)

---

## Implementation Priority

### Phase 1: Critical (Do First)
1. ✅ Update `.github/copilot-instructions.md` with custom agent section
2. ✅ Fix `.github/agents/publisher.agent.md` (remove runSubagent, add task examples)

### Phase 2: Important (Do Soon)
3. ✅ Update issue template in `daily-agent.yml` with agent reference
4. ✅ Test workflow with custom agent delegation

### Phase 3: Cleanup (Do Later)
5. ⚠️ Archive feed-fetcher and change-detector agents
6. ⚠️ Document agent lifecycle in README

---

## Expected Benefits

After implementing these changes:

### ✅ Better Separation of Concerns
- Publisher orchestrates
- Content-generator handles complex formatting
- Link-validator ensures quality

### ✅ More Maintainable
- Each agent has clear responsibility
- Easier to debug and improve
- Better code reuse

### ✅ Higher Quality
- Specialized agents are experts in their domain
- Link-validator acts as mandatory quality gate
- Consistent formatting patterns

### ✅ Follows Best Practices
- Aligns with recommendations in AGENT_WORKFLOW_ANALYSIS.md
- Uses GitHub Copilot's intended custom agent pattern
- Clear delegation hierarchy

---

## Testing Plan

After implementing Solution 1 & 2:

1. **Manual test**: Trigger workflow manually
   ```bash
   gh workflow run daily-agent.yml
   ```

2. **Verify** @copilot:
   - Reads copilot-instructions.md
   - Sees custom agent section
   - Uses `task` tool to delegate
   - Calls content-generator for WHATS-NEW.md
   - Calls link-validator after content generation

3. **Check PR**: Should show evidence of delegation in conversation

---

## Conclusion

**Root Cause**: `.github/copilot-instructions.md` doesn't inform @copilot about custom agents or the `task` tool.

**Fix**: Add custom agent documentation to copilot-instructions.md and fix publisher agent config.

**Impact**: @copilot will properly delegate to specialized agents, improving code quality and maintainability.

**Status**: Analysis complete. Ready for implementation (BUT NOT IMPLEMENTING YET per user request).
