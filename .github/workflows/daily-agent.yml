name: Daily Copilot Digest

# Creates an issue daily for Copilot coding agent to process.
# The agent will run copilot-setup-steps.yml to fetch fresh data before working.
on:
  workflow_dispatch:       # Allow manual triggering
  schedule:
    - cron: '14 23 * * *'

permissions:
  issues: write            # Required to create issues

jobs:
  create-issue:
    runs-on: ubuntu-latest
    
    steps:
      - name: Create Issue for Copilot Coding Agent
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          BODY="Daily Content Update - Generate content from fresh data and update all files in content/ directory. See .github/copilot-instructions.md for workflow details."
          ISSUE_URL=$(gh issue create \
            --repo ${{ github.repository }} \
            --title "ğŸ“° Content Update - $(date +'%Y-%m-%d')" \
            --label "content-update" \
            --label "automation" \
            --body "$BODY")
          
          echo "ğŸ“ Created issue: ${ISSUE_URL}"
          echo "ğŸ”§ Assign to Copilot in GitHub UI to start content generation."
