name: Daily Copilot Digest

# Creates an issue daily for Copilot coding agent to process.
# The agent will run copilot-setup-steps.yml to fetch fresh data before working.
on:
  schedule:
    - cron: '14 23 * * *'  # Daily at 11:14 PM UTC
  workflow_dispatch:       # Allows manual triggering

permissions:
  issues: write            # Required to create issues

jobs:
  create-issue:
    runs-on: ubuntu-latest
    
    steps:
      - name: Create Issue for Copilot Coding Agent
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          # Create issue for Copilot coding agent
          ISSUE_URL=$(gh issue create \
            --repo ${{ github.repository }} \
            --title "ğŸ“° Content Update - $(date +'%Y-%m-%d')" \
            --label "content-update" \
            --label "automation" \
            --body "## ğŸ¤– Daily Content Update Task

### ğŸ“‹ Task
Generate content from fresh data and update all files in \`content/\` directory.

**Follow the workflow in \`.github/copilot-instructions.md\`**:
1. Verify data availability in \`data/\`
2. Generate/update all 9 content files
3. Run validation scripts (\`validate_whats_new.py\`, \`validate_links.py\`)
4. Fix any issues found

### âœ… Success Criteria
- All content files updated based on \`data/changes-summary.json\`
- Dates complete and sorted (newest first)
- Link validation passed
- GitHub Next content has experimental disclaimers

### ğŸ“š Reference
- Workflow: \`.github/copilot-instructions.md\`
- Data: \`data/\` directory (fetched by copilot-setup-steps.yml)
- Content: \`content/\` directory

---

**Next Step**: Assign this issue to Copilot to automatically generate a PR.")
          
          echo "ğŸ“ Created issue: ${ISSUE_URL}"
          echo "ğŸ”§ Assign to Copilot in GitHub UI to start content generation."
